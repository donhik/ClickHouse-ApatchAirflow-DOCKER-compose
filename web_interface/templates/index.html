{% extends "base.html" %}

{% block content %}
<div class="dashboard">
    <h2>üìà –î–∞—à–±–æ—Ä–¥ –≤–∞–∫–∞–Ω—Å–∏–π HH.ru</h2>
    
    <div class="stats-grid">
        <div class="stat-card">
            <h3>–í—Å–µ–≥–æ –≤–∞–∫–∞–Ω—Å–∏–π</h3>
            <p class="stat-number">{{ stats.total_vacancies }}</p>
            <p class="stat-subtitle">–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: {{ stats.last_update }}</p>
        </div>
        
        <div class="stat-card">
            <h3>–°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞</h3>
            <p class="stat-number">{{ stats.avg_salary|int }} ‚ÇΩ</p>
            <p class="stat-subtitle">–¢–æ–ª—å–∫–æ –≤ —Ä—É–±–ª—è—Ö (RUR)</p>
        </div>
        
        <div class="stat-card">
            <h3>Airflow Status</h3>
            <p class="stat-number {% if airflow_status.status == 'healthy' %}success{% elif airflow_status.status == 'error' %}error{% endif %}">
                {{ airflow_status.status }}
            </p>
        </div>
    </div>
    
    <!-- –¢–æ–ø –∫–æ–º–ø–∞–Ω–∏–π -->
    <div class="section">
        <h3>üèÜ –¢–æ–ø –∫–æ–º–ø–∞–Ω–∏–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≤–∞–∫–∞–Ω—Å–∏–π</h3>
        <ul class="top-companies">
            {% for company in stats.top_companies %}
            <li>{{ company.name }} <span class="count-badge">{{ company.count }}</span></li>
            {% endfor %}
        </ul>
    </div>
    
    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏ -->
    <div class="section">
        <h3>üÜï –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏</h3>
        <div class="vacancies-list">
            {% for vacancy in stats.recent_vacancies %}
            <div class="vacancy-card">
                <h4>{{ vacancy.title }}</h4>
                <p class="company">{{ vacancy.company }}</p>
                <p class="location">üìç {{ vacancy.city }}</p>
                <p class="salary">
                    {% if vacancy.salary_from > 0 and vacancy.salary_to > 0 %}
                    {{ vacancy.salary_from|int }} - {{ vacancy.salary_to|int }} ‚ÇΩ
                    {% elif vacancy.salary_from > 0 %}
                    –æ—Ç {{ vacancy.salary_from|int }} ‚ÇΩ
                    {% elif vacancy.salary_to > 0 %}
                    –¥–æ {{ vacancy.salary_to|int }} ‚ÇΩ
                    {% endif %}
                </p>
                <p class="date">{{ vacancy.published_date }}</p>
            </div>
            {% endfor %}
        </div>
    </div>
    
    <div class="quick-actions">
        <a href="{{ url_for('analytics') }}" class="btn-primary">üìä –ü–æ–¥—Ä–æ–±–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</a>
        <a href="{{ url_for('query') }}" class="btn-secondary">üîç SQL –∑–∞–ø—Ä–æ—Å—ã</a>
        <a href="http://localhost:8080" target="_blank" class="btn-secondary">‚úàÔ∏è Airflow DAGs</a>
    </div>
</div>
{% endblock %}